spring:
  jpa:
    database-platform: org.hibernate.dialect.MySQLDialect
    show-sql: true
    hibernate:
      ddl-auto: none
    open-in-view: false
    database: mysql
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
  shardingsphere:
    mode:
      overwrite: true
      type: Standalone
      repository:
        type: File
        props:
          path: sharding-config
    # 配置库
    datasource:
      names: ds0,ds1
      ds0:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://localhost:3306/ds0
        username: test
        password: test
      ds1:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://localhost:3306/ds1
        username: test
        password: test
    rules:
      sharding:
        sharding-algorithms:
          default-database-sharding:
            type: INLINE
            props:
              algorithm-expression: ds$->{f_id % 2}
          user-table-sharding:
            type: INLINE
            props:
              algorithm-expression: t_user_$->{f_id % 10}
          custom-created-table-sharding:
            type: CLASS_BASED
            props:
              strategy: STANDARD
              algorithmClassName: com.learning.sharding.CreatedTableSharingAlgorithm
        keyGenerators:
          snow-flake:
            type: SNOWFLAKE
            props:
              worker-id: 123
        default-key-generate-strategy:
          column: f_id
          key-generator-name: snow-flake
        default-database-strategy:
          standard:
            sharding-column: f_id
            sharding-algorithm-name: default-database-sharding
        tables:
          # 表规则
          t_user:
            actual-data-nodes: ds$->{0..1}.t_user_$->{0..9}
            table-strategy:
              standard:
                sharding-column: f_id
                sharding-algorithm-name: user-table-sharding
          t_order:
            actual-data-nodes: ds$->{0..1}.t_order_$->{202201..202212}
            table-strategy:
              standard:
                sharding-column: f_created_at
                sharding-algorithm-name: custom-created-table-sharding
          t_city:
            actual-data-nodes: ds$->{0..1}.t_city
        broadcast-tables:
          - t_city
    props:
      sql-show: true
  level:
    com:
      light:
        sharding:
          jdbc: debug
